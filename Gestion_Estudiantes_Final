#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>

#define MAX_MATERIAS 8
#define MAX_NOMBRE 50
#define MAX_APELLIDO 50
#define MAX_DNI 10
#define MAX_EMAIL 50
#define MAX_DIRECCION 100
#define MAX_TELEFONO 15

typedef struct Estudiante {
	char nombre[MAX_NOMBRE];
	char apellido[MAX_APELLIDO];
	char dni[MAX_DNI];
	char email[MAX_EMAIL];
	char direccion[MAX_DIRECCION];
	char telefono[MAX_TELEFONO];
	char contactoEmergencia[MAX_TELEFONO];
	int legajo;
	float notas[MAX_MATERIAS];
	int inasistencias[MAX_MATERIAS];
	int materiasCursadas[MAX_MATERIAS];
	struct Estudiante *siguiente;
} Estudiante;

Estudiante *lista = NULL;
int contadorLegajo = 1;

// Prototipos
int validarEmail(const char *email);
int validarDNI(const char *dni);
int validarTelefono(const char *telefono);
void mostrarMenu();
void ingresarNotas(Estudiante *est);
void mostrarEstudiante(Estudiante *e);
void cargarEstudiante();
void buscarEstudiante();
void mostrarMejoresPromedios();

//Procedimiento para Validar Mail(Logica Principal del Programa)
int validarEmail(const char *email) {
	const char *arroba = strchr(email, '@');
	const char *punto = strrchr(email, '.');
	return (arroba && punto && punto > arroba && arroba != email && *(punto + 1) != '\0');
}

//Procedimiento para Validar DNI(Logica Principal del Programa)
int validarDNI(const char *dni) {
	if (strlen(dni) != 8) return 0;
	for (int i = 0; dni[i]; i++) if (!isdigit(dni[i])) return 0;
	return 1;
}


//Procedimiento para Validar Telefono(Logica Principal del Programa)
int validarTelefono(const char *telefono) {
	if (strlen(telefono) != 10) return 0;
	for (int i = 0; i < 10; i++) if (!isdigit(telefono[i])) return 0;
	return 1;
}

//Procedimiento para Mostrar el MenÃº(Logica Principal del Programa)
void mostrarMenu() {
	printf("\n=========== MENU ===========\n");
	printf("1. Cargar Estudiante\n");
	printf("2. Mostrar Datos de Estudiantes\n");
	printf("3. Buscar Estudiante\n");
	printf("4. Mostrar Top 3 Promedios\n");
	printf("5. Eliminar Estudiante\n");
	printf("6. Guardar en Archivo\n");
	printf("7. Salir\n");
	printf("============================\n");
}
